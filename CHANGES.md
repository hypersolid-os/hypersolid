Changelog
============================

Branch 2.x
---------------------------

### 2.3.0 ###

* Changed: build process will fail on any `dpkg configure` packages errors (status!=installed)
* Bugfix: `awk` may be unavailable during `dpkg configure` because of missing package deps. set symlink to `/usr/bin/mawk`

### 2.2.2 ###

* Bugfix: workspace specific `hypersolid.conf` were no able to override buildenv paths (loaded after buildenv build)

### 2.2.1 ###

* Bugfix: qemu-arm-static binaries missing within mmdebstrap

### 2.2.0 ###

* Changed: build-env is created by [mmdebstrap](https://manpages.debian.org/testing/mmdebstrap/mmdebstrap.1.en.html)

### 2.1.1 ###

* Bugfix: path variable `BUILD_ENV` not honored as container root

### 2.1.0 ###

* Added: simultaneous multiarch build support (build multiple archs for single target at once)
* Added: exposed `$BUILDARCH` variable within multistrap file to match arch specific packages

### 2.0.0 ###

* Changed: buildarch is appended to all output files (e.g. `kernel-<arch>.img`, `.uuid-arch`). this also affects the initramfs squashfs mount. legacy filename `system.img` is also still supported as fallback
* Changed: dist (output) dir renamed to `.dist/`
* Changed: `hypersolid.conf` and target `config` loaded for detached `sign`/`deploy` commands

Branch 1.x
---------------------------

### 1.7.0 ###

* Changed: moved `hypersolid-firstboot` to `/usr/lib/hypersolid/firstboot`
* Changed: `/etc/machine-id` removed from image and dynamically generated by `firstboot`

### 1.6.0 ###

* Added: `systemd-timesyncd` to `systemd` section
* Added: `rfkill` to `wireless` section
* Changed: removed `dhcpcd5` package in default `network` section (systemd-networkd is preferred)

### 1.5.0 ###

* Added: `uuid` is automatically generated for each build and stored in `DIST_DIR/.uuid` - can be assigned within `pre-build` hook
* Bugfix: `CONF_IMAGE_TYPE=cpio` failed because of invalid path
* Bugfix: build environment multistrap file was altered by global mirror configuration - copy moved into env build dir

### 1.4.0 ###

* Added: multistrap sources/mirrors can be configured via global configuration `hypersolid.conf` to enable usage of custom mirrors without changing basic multistrap files (affects also the build system wrapper)
* Changed: build-system updated to debian bullseye
* Changed: multistrap `omitdebsrc=true` is set for all standard sections to avoid download of source files
* Changed: `firmware-ralink` replaced by `firmware-misc-nonfree` in `multistrap/bullseye.ini`

### 1.3.0 ###

* Added: support for derived images from multiple source targets (multiple inheritance)

### 1.2.1 ###

* Changed: max overlay `tmpfs` size to `75%` of total system ram

### 1.2.0 ###

* Added: `pstorage reload` command to clear filesystem cache - apply changes made in lowerdir
* Added: `pstorage persist <path>` command to apply all configurations changes of the given path to the persistent config storage via rsync
* Added: debian **bullseye** multistrap sources
* Changed: busybox binaries included as assets
* Changed: ssh host keys on firstboot are directly generated by `ssh-keygen`

### 1.1.0 ###

* Added: support for derived images (inheritance)
* Added: support for `.d` style setup scripts
* Updated: `bash-functions` to `v0.3.0`

### 1.0.0 ###

* **Stable release**
* Replaced docker based build environment with `systemd-nspawn`
* Refactored the whole build process
* Changed: build directory structure and variable names
* Changed: multistrap configurations are named by the debian release

Preliminary
---------------------------

* Docker isolated build environment